{"ast":null,"code":"/* await-timeout v0.6.0 by Vitaliy Potapov */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = global || self, global.Timeout = factory());\n})(this, function () {\n  'use strict';\n\n  function promiseFinally(promise, fn) {\n    const success = result => {\n      fn();\n      return result;\n    };\n\n    const error = e => {\n      fn();\n      return Promise.reject(e);\n    };\n\n    return Promise.resolve(promise).then(success, error);\n  }\n  /**\n   * Converts any value to Error.\n   * @param {*} value\n   * @returns {Error}\n   */\n\n\n  function toError(value) {\n    value = typeof value === 'function' ? value() : value;\n    return typeof value === 'string' ? new Error(value) : value;\n  }\n  /**\n   * Promise-based replacement for setTimeout / clearTimeout.\n   */\n\n\n  class Timeout {\n    constructor() {\n      this._id = null;\n      this._delay = null;\n    }\n\n    get id() {\n      return this._id;\n    }\n\n    get delay() {\n      return this._delay;\n    }\n\n    set(delay, rejectReason = '') {\n      return new Promise((resolve, reject) => {\n        this.clear();\n        const fn = rejectReason ? () => reject(toError(rejectReason)) : resolve;\n        this._id = setTimeout(fn, delay);\n        this._delay = delay;\n      });\n    }\n\n    wrap(promise, delay, rejectReason = '') {\n      const wrappedPromise = promiseFinally(promise, () => this.clear());\n      const timer = this.set(delay, rejectReason);\n      return Promise.race([wrappedPromise, timer]);\n    }\n\n    clear() {\n      if (this._id) {\n        clearTimeout(this._id);\n      }\n    }\n\n  }\n\n  Timeout.set = function (delay, rejectReason) {\n    return new Timeout().set(delay, rejectReason);\n  };\n\n  Timeout.wrap = function (promise, delay, rejectReason) {\n    return new Timeout().wrap(promise, delay, rejectReason);\n  };\n\n  return Timeout;\n});","map":{"version":3,"sources":["/home/x/reach/kick/github/node_modules/await-timeout/dist/es6.js"],"names":["global","factory","exports","module","define","amd","self","Timeout","promiseFinally","promise","fn","success","result","error","e","Promise","reject","resolve","then","toError","value","Error","constructor","_id","_delay","id","delay","set","rejectReason","clear","setTimeout","wrap","wrappedPromise","timer","race","clearTimeout"],"mappings":"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","sourcesContent":["/* await-timeout v0.6.0 by Vitaliy Potapov */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.Timeout = factory());\n}(this, function () { 'use strict';\n\n  function promiseFinally(promise, fn) {\n    const success = result => {\n      fn();\n      return result;\n    };\n    const error = e => {\n      fn();\n      return Promise.reject(e);\n    };\n    return Promise.resolve(promise).then(success, error);\n  }\n\n  /**\n   * Converts any value to Error.\n   * @param {*} value\n   * @returns {Error}\n   */\n  function toError(value) {\n    value = typeof value === 'function' ? value() : value;\n    return typeof value === 'string' ? new Error(value) : value;\n  }\n\n  /**\n   * Promise-based replacement for setTimeout / clearTimeout.\n   */\n\n  class Timeout {\n    constructor() {\n      this._id = null;\n      this._delay = null;\n    }\n\n    get id() {\n      return this._id;\n    }\n\n    get delay() {\n      return this._delay;\n    }\n\n    set(delay, rejectReason = '') {\n      return new Promise((resolve, reject) => {\n        this.clear();\n        const fn = rejectReason ? () => reject(toError(rejectReason)) : resolve;\n        this._id = setTimeout(fn, delay);\n        this._delay = delay;\n      });\n    }\n\n    wrap(promise, delay, rejectReason = '') {\n      const wrappedPromise = promiseFinally(promise, () => this.clear());\n      const timer = this.set(delay, rejectReason);\n      return Promise.race([wrappedPromise, timer]);\n    }\n\n    clear() {\n      if (this._id) {\n        clearTimeout(this._id);\n      }\n    }\n  }\n\n  Timeout.set = function (delay, rejectReason) {\n    return new Timeout().set(delay, rejectReason);\n  };\n\n  Timeout.wrap = function (promise, delay, rejectReason) {\n    return new Timeout().wrap(promise, delay, rejectReason);\n  };\n\n  return Timeout;\n\n}));\n"]},"metadata":{},"sourceType":"script"}